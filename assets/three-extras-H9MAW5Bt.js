import{C as At,V as l,M as F,T as q,Q as E,S as _t,a as T,R as zt,P as Ht,b as Qt,c as Nt,O as lt,d as It,L as Ut,e as b,B as _,f as ft,F as yt,g as h,h as st,i as k,j as W,k as qt,E as Ft,l as vt,m as Wt,D as Kt,n as Gt,o as wt,p as Bt,q as Vt,I as $t,r as Jt}from"./three-core-qRc6AwJP.js";const bt={type:"change"},ut={type:"start"},Ot={type:"end"},ot=new zt,gt=new Ht,te=Math.cos(70*Qt.DEG2RAD),m=new l,g=2*Math.PI,c={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_PAN:4,TOUCH_DOLLY_PAN:5,TOUCH_DOLLY_ROTATE:6},ct=1e-6;class Me extends At{constructor(t,e=null){super(t,e),this.state=c.NONE,this.target=new l,this.cursor=new l,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minTargetRadius=0,this.maxTargetRadius=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.05,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.keyRotateSpeed=1,this.enablePan=!0,this.panSpeed=1,this.screenSpacePanning=!0,this.keyPanSpeed=7,this.zoomToCursor=!1,this.autoRotate=!1,this.autoRotateSpeed=2,this.keys={LEFT:"ArrowLeft",UP:"ArrowUp",RIGHT:"ArrowRight",BOTTOM:"ArrowDown"},this.mouseButtons={LEFT:F.ROTATE,MIDDLE:F.DOLLY,RIGHT:F.PAN},this.touches={ONE:q.ROTATE,TWO:q.DOLLY_PAN},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this._domElementKeyEvents=null,this._lastPosition=new l,this._lastQuaternion=new E,this._lastTargetPosition=new l,this._quat=new E().setFromUnitVectors(t.up,new l(0,1,0)),this._quatInverse=this._quat.clone().invert(),this._spherical=new _t,this._sphericalDelta=new _t,this._scale=1,this._panOffset=new l,this._rotateStart=new T,this._rotateEnd=new T,this._rotateDelta=new T,this._panStart=new T,this._panEnd=new T,this._panDelta=new T,this._dollyStart=new T,this._dollyEnd=new T,this._dollyDelta=new T,this._dollyDirection=new l,this._mouse=new T,this._performCursorZoom=!1,this._pointers=[],this._pointerPositions={},this._controlActive=!1,this._onPointerMove=ie.bind(this),this._onPointerDown=ee.bind(this),this._onPointerUp=se.bind(this),this._onContextMenu=ce.bind(this),this._onMouseWheel=ae.bind(this),this._onKeyDown=re.bind(this),this._onTouchStart=he.bind(this),this._onTouchMove=le.bind(this),this._onMouseDown=oe.bind(this),this._onMouseMove=ne.bind(this),this._interceptControlDown=pe.bind(this),this._interceptControlUp=de.bind(this),this.domElement!==null&&this.connect(this.domElement),this.update()}connect(t){super.connect(t),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointercancel",this._onPointerUp),this.domElement.addEventListener("contextmenu",this._onContextMenu),this.domElement.addEventListener("wheel",this._onMouseWheel,{passive:!1}),this.domElement.getRootNode().addEventListener("keydown",this._interceptControlDown,{passive:!0,capture:!0}),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.domElement.removeEventListener("pointercancel",this._onPointerUp),this.domElement.removeEventListener("wheel",this._onMouseWheel),this.domElement.removeEventListener("contextmenu",this._onContextMenu),this.stopListenToKeyEvents(),this.domElement.getRootNode().removeEventListener("keydown",this._interceptControlDown,{capture:!0}),this.domElement.style.touchAction="auto"}dispose(){this.disconnect()}getPolarAngle(){return this._spherical.phi}getAzimuthalAngle(){return this._spherical.theta}getDistance(){return this.object.position.distanceTo(this.target)}listenToKeyEvents(t){t.addEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=t}stopListenToKeyEvents(){this._domElementKeyEvents!==null&&(this._domElementKeyEvents.removeEventListener("keydown",this._onKeyDown),this._domElementKeyEvents=null)}saveState(){this.target0.copy(this.target),this.position0.copy(this.object.position),this.zoom0=this.object.zoom}reset(){this.target.copy(this.target0),this.object.position.copy(this.position0),this.object.zoom=this.zoom0,this.object.updateProjectionMatrix(),this.dispatchEvent(bt),this.update(),this.state=c.NONE}update(t=null){const e=this.object.position;m.copy(e).sub(this.target),m.applyQuaternion(this._quat),this._spherical.setFromVector3(m),this.autoRotate&&this.state===c.NONE&&this._rotateLeft(this._getAutoRotationAngle(t)),this.enableDamping?(this._spherical.theta+=this._sphericalDelta.theta*this.dampingFactor,this._spherical.phi+=this._sphericalDelta.phi*this.dampingFactor):(this._spherical.theta+=this._sphericalDelta.theta,this._spherical.phi+=this._sphericalDelta.phi);let o=this.minAzimuthAngle,s=this.maxAzimuthAngle;isFinite(o)&&isFinite(s)&&(o<-Math.PI?o+=g:o>Math.PI&&(o-=g),s<-Math.PI?s+=g:s>Math.PI&&(s-=g),o<=s?this._spherical.theta=Math.max(o,Math.min(s,this._spherical.theta)):this._spherical.theta=this._spherical.theta>(o+s)/2?Math.max(o,this._spherical.theta):Math.min(s,this._spherical.theta)),this._spherical.phi=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,this._spherical.phi)),this._spherical.makeSafe(),this.enableDamping===!0?this.target.addScaledVector(this._panOffset,this.dampingFactor):this.target.add(this._panOffset),this.target.sub(this.cursor),this.target.clampLength(this.minTargetRadius,this.maxTargetRadius),this.target.add(this.cursor);let r=!1;if(this.zoomToCursor&&this._performCursorZoom||this.object.isOrthographicCamera)this._spherical.radius=this._clampDistance(this._spherical.radius);else{const i=this._spherical.radius;this._spherical.radius=this._clampDistance(this._spherical.radius*this._scale),r=i!=this._spherical.radius}if(m.setFromSpherical(this._spherical),m.applyQuaternion(this._quatInverse),e.copy(this.target).add(m),this.object.lookAt(this.target),this.enableDamping===!0?(this._sphericalDelta.theta*=1-this.dampingFactor,this._sphericalDelta.phi*=1-this.dampingFactor,this._panOffset.multiplyScalar(1-this.dampingFactor)):(this._sphericalDelta.set(0,0,0),this._panOffset.set(0,0,0)),this.zoomToCursor&&this._performCursorZoom){let i=null;if(this.object.isPerspectiveCamera){const n=m.length();i=this._clampDistance(n*this._scale);const u=n-i;this.object.position.addScaledVector(this._dollyDirection,u),this.object.updateMatrixWorld(),r=!!u}else if(this.object.isOrthographicCamera){const n=new l(this._mouse.x,this._mouse.y,0);n.unproject(this.object);const u=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),this.object.updateProjectionMatrix(),r=u!==this.object.zoom;const y=new l(this._mouse.x,this._mouse.y,0);y.unproject(this.object),this.object.position.sub(y).add(n),this.object.updateMatrixWorld(),i=m.length()}else console.warn("WARNING: OrbitControls.js encountered an unknown camera type - zoom to cursor disabled."),this.zoomToCursor=!1;i!==null&&(this.screenSpacePanning?this.target.set(0,0,-1).transformDirection(this.object.matrix).multiplyScalar(i).add(this.object.position):(ot.origin.copy(this.object.position),ot.direction.set(0,0,-1).transformDirection(this.object.matrix),Math.abs(this.object.up.dot(ot.direction))<te?this.object.lookAt(this.target):(gt.setFromNormalAndCoplanarPoint(this.object.up,this.target),ot.intersectPlane(gt,this.target))))}else if(this.object.isOrthographicCamera){const i=this.object.zoom;this.object.zoom=Math.max(this.minZoom,Math.min(this.maxZoom,this.object.zoom/this._scale)),i!==this.object.zoom&&(this.object.updateProjectionMatrix(),r=!0)}return this._scale=1,this._performCursorZoom=!1,r||this._lastPosition.distanceToSquared(this.object.position)>ct||8*(1-this._lastQuaternion.dot(this.object.quaternion))>ct||this._lastTargetPosition.distanceToSquared(this.target)>ct?(this.dispatchEvent(bt),this._lastPosition.copy(this.object.position),this._lastQuaternion.copy(this.object.quaternion),this._lastTargetPosition.copy(this.target),!0):!1}_getAutoRotationAngle(t){return t!==null?g/60*this.autoRotateSpeed*t:g/60/60*this.autoRotateSpeed}_getZoomScale(t){const e=Math.abs(t*.01);return Math.pow(.95,this.zoomSpeed*e)}_rotateLeft(t){this._sphericalDelta.theta-=t}_rotateUp(t){this._sphericalDelta.phi-=t}_panLeft(t,e){m.setFromMatrixColumn(e,0),m.multiplyScalar(-t),this._panOffset.add(m)}_panUp(t,e){this.screenSpacePanning===!0?m.setFromMatrixColumn(e,1):(m.setFromMatrixColumn(e,0),m.crossVectors(this.object.up,m)),m.multiplyScalar(t),this._panOffset.add(m)}_pan(t,e){const o=this.domElement;if(this.object.isPerspectiveCamera){const s=this.object.position;m.copy(s).sub(this.target);let r=m.length();r*=Math.tan(this.object.fov/2*Math.PI/180),this._panLeft(2*t*r/o.clientHeight,this.object.matrix),this._panUp(2*e*r/o.clientHeight,this.object.matrix)}else this.object.isOrthographicCamera?(this._panLeft(t*(this.object.right-this.object.left)/this.object.zoom/o.clientWidth,this.object.matrix),this._panUp(e*(this.object.top-this.object.bottom)/this.object.zoom/o.clientHeight,this.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),this.enablePan=!1)}_dollyOut(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale/=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_dollyIn(t){this.object.isPerspectiveCamera||this.object.isOrthographicCamera?this._scale*=t:(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),this.enableZoom=!1)}_updateZoomParameters(t,e){if(!this.zoomToCursor)return;this._performCursorZoom=!0;const o=this.domElement.getBoundingClientRect(),s=t-o.left,r=e-o.top,i=o.width,n=o.height;this._mouse.x=s/i*2-1,this._mouse.y=-(r/n)*2+1,this._dollyDirection.set(this._mouse.x,this._mouse.y,1).unproject(this.object).sub(this.object.position).normalize()}_clampDistance(t){return Math.max(this.minDistance,Math.min(this.maxDistance,t))}_handleMouseDownRotate(t){this._rotateStart.set(t.clientX,t.clientY)}_handleMouseDownDolly(t){this._updateZoomParameters(t.clientX,t.clientX),this._dollyStart.set(t.clientX,t.clientY)}_handleMouseDownPan(t){this._panStart.set(t.clientX,t.clientY)}_handleMouseMoveRotate(t){this._rotateEnd.set(t.clientX,t.clientY),this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement;this._rotateLeft(g*this._rotateDelta.x/e.clientHeight),this._rotateUp(g*this._rotateDelta.y/e.clientHeight),this._rotateStart.copy(this._rotateEnd),this.update()}_handleMouseMoveDolly(t){this._dollyEnd.set(t.clientX,t.clientY),this._dollyDelta.subVectors(this._dollyEnd,this._dollyStart),this._dollyDelta.y>0?this._dollyOut(this._getZoomScale(this._dollyDelta.y)):this._dollyDelta.y<0&&this._dollyIn(this._getZoomScale(this._dollyDelta.y)),this._dollyStart.copy(this._dollyEnd),this.update()}_handleMouseMovePan(t){this._panEnd.set(t.clientX,t.clientY),this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd),this.update()}_handleMouseWheel(t){this._updateZoomParameters(t.clientX,t.clientY),t.deltaY<0?this._dollyIn(this._getZoomScale(t.deltaY)):t.deltaY>0&&this._dollyOut(this._getZoomScale(t.deltaY)),this.update()}_handleKeyDown(t){let e=!1;switch(t.code){case this.keys.UP:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(g*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,this.keyPanSpeed),e=!0;break;case this.keys.BOTTOM:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateUp(-g*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(0,-this.keyPanSpeed),e=!0;break;case this.keys.LEFT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(g*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(this.keyPanSpeed,0),e=!0;break;case this.keys.RIGHT:t.ctrlKey||t.metaKey||t.shiftKey?this.enableRotate&&this._rotateLeft(-g*this.keyRotateSpeed/this.domElement.clientHeight):this.enablePan&&this._pan(-this.keyPanSpeed,0),e=!0;break}e&&(t.preventDefault(),this.update())}_handleTouchStartRotate(t){if(this._pointers.length===1)this._rotateStart.set(t.pageX,t.pageY);else{const e=this._getSecondPointerPosition(t),o=.5*(t.pageX+e.x),s=.5*(t.pageY+e.y);this._rotateStart.set(o,s)}}_handleTouchStartPan(t){if(this._pointers.length===1)this._panStart.set(t.pageX,t.pageY);else{const e=this._getSecondPointerPosition(t),o=.5*(t.pageX+e.x),s=.5*(t.pageY+e.y);this._panStart.set(o,s)}}_handleTouchStartDolly(t){const e=this._getSecondPointerPosition(t),o=t.pageX-e.x,s=t.pageY-e.y,r=Math.sqrt(o*o+s*s);this._dollyStart.set(0,r)}_handleTouchStartDollyPan(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enablePan&&this._handleTouchStartPan(t)}_handleTouchStartDollyRotate(t){this.enableZoom&&this._handleTouchStartDolly(t),this.enableRotate&&this._handleTouchStartRotate(t)}_handleTouchMoveRotate(t){if(this._pointers.length==1)this._rotateEnd.set(t.pageX,t.pageY);else{const o=this._getSecondPointerPosition(t),s=.5*(t.pageX+o.x),r=.5*(t.pageY+o.y);this._rotateEnd.set(s,r)}this._rotateDelta.subVectors(this._rotateEnd,this._rotateStart).multiplyScalar(this.rotateSpeed);const e=this.domElement;this._rotateLeft(g*this._rotateDelta.x/e.clientHeight),this._rotateUp(g*this._rotateDelta.y/e.clientHeight),this._rotateStart.copy(this._rotateEnd)}_handleTouchMovePan(t){if(this._pointers.length===1)this._panEnd.set(t.pageX,t.pageY);else{const e=this._getSecondPointerPosition(t),o=.5*(t.pageX+e.x),s=.5*(t.pageY+e.y);this._panEnd.set(o,s)}this._panDelta.subVectors(this._panEnd,this._panStart).multiplyScalar(this.panSpeed),this._pan(this._panDelta.x,this._panDelta.y),this._panStart.copy(this._panEnd)}_handleTouchMoveDolly(t){const e=this._getSecondPointerPosition(t),o=t.pageX-e.x,s=t.pageY-e.y,r=Math.sqrt(o*o+s*s);this._dollyEnd.set(0,r),this._dollyDelta.set(0,Math.pow(this._dollyEnd.y/this._dollyStart.y,this.zoomSpeed)),this._dollyOut(this._dollyDelta.y),this._dollyStart.copy(this._dollyEnd);const i=(t.pageX+e.x)*.5,n=(t.pageY+e.y)*.5;this._updateZoomParameters(i,n)}_handleTouchMoveDollyPan(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enablePan&&this._handleTouchMovePan(t)}_handleTouchMoveDollyRotate(t){this.enableZoom&&this._handleTouchMoveDolly(t),this.enableRotate&&this._handleTouchMoveRotate(t)}_addPointer(t){this._pointers.push(t.pointerId)}_removePointer(t){delete this._pointerPositions[t.pointerId];for(let e=0;e<this._pointers.length;e++)if(this._pointers[e]==t.pointerId){this._pointers.splice(e,1);return}}_isTrackingPointer(t){for(let e=0;e<this._pointers.length;e++)if(this._pointers[e]==t.pointerId)return!0;return!1}_trackPointer(t){let e=this._pointerPositions[t.pointerId];e===void 0&&(e=new T,this._pointerPositions[t.pointerId]=e),e.set(t.pageX,t.pageY)}_getSecondPointerPosition(t){const e=t.pointerId===this._pointers[0]?this._pointers[1]:this._pointers[0];return this._pointerPositions[e]}_customWheelEvent(t){const e=t.deltaMode,o={clientX:t.clientX,clientY:t.clientY,deltaY:t.deltaY};switch(e){case 1:o.deltaY*=16;break;case 2:o.deltaY*=100;break}return t.ctrlKey&&!this._controlActive&&(o.deltaY*=10),o}}function ee(a){this.enabled!==!1&&(this._pointers.length===0&&(this.domElement.setPointerCapture(a.pointerId),this.domElement.ownerDocument.addEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.addEventListener("pointerup",this._onPointerUp)),!this._isTrackingPointer(a)&&(this._addPointer(a),a.pointerType==="touch"?this._onTouchStart(a):this._onMouseDown(a)))}function ie(a){this.enabled!==!1&&(a.pointerType==="touch"?this._onTouchMove(a):this._onMouseMove(a))}function se(a){switch(this._removePointer(a),this._pointers.length){case 0:this.domElement.releasePointerCapture(a.pointerId),this.domElement.ownerDocument.removeEventListener("pointermove",this._onPointerMove),this.domElement.ownerDocument.removeEventListener("pointerup",this._onPointerUp),this.dispatchEvent(Ot),this.state=c.NONE;break;case 1:const t=this._pointers[0],e=this._pointerPositions[t];this._onTouchStart({pointerId:t,pageX:e.x,pageY:e.y});break}}function oe(a){let t;switch(a.button){case 0:t=this.mouseButtons.LEFT;break;case 1:t=this.mouseButtons.MIDDLE;break;case 2:t=this.mouseButtons.RIGHT;break;default:t=-1}switch(t){case F.DOLLY:if(this.enableZoom===!1)return;this._handleMouseDownDolly(a),this.state=c.DOLLY;break;case F.ROTATE:if(a.ctrlKey||a.metaKey||a.shiftKey){if(this.enablePan===!1)return;this._handleMouseDownPan(a),this.state=c.PAN}else{if(this.enableRotate===!1)return;this._handleMouseDownRotate(a),this.state=c.ROTATE}break;case F.PAN:if(a.ctrlKey||a.metaKey||a.shiftKey){if(this.enableRotate===!1)return;this._handleMouseDownRotate(a),this.state=c.ROTATE}else{if(this.enablePan===!1)return;this._handleMouseDownPan(a),this.state=c.PAN}break;default:this.state=c.NONE}this.state!==c.NONE&&this.dispatchEvent(ut)}function ne(a){switch(this.state){case c.ROTATE:if(this.enableRotate===!1)return;this._handleMouseMoveRotate(a);break;case c.DOLLY:if(this.enableZoom===!1)return;this._handleMouseMoveDolly(a);break;case c.PAN:if(this.enablePan===!1)return;this._handleMouseMovePan(a);break}}function ae(a){this.enabled===!1||this.enableZoom===!1||this.state!==c.NONE||(a.preventDefault(),this.dispatchEvent(ut),this._handleMouseWheel(this._customWheelEvent(a)),this.dispatchEvent(Ot))}function re(a){this.enabled!==!1&&this._handleKeyDown(a)}function he(a){switch(this._trackPointer(a),this._pointers.length){case 1:switch(this.touches.ONE){case q.ROTATE:if(this.enableRotate===!1)return;this._handleTouchStartRotate(a),this.state=c.TOUCH_ROTATE;break;case q.PAN:if(this.enablePan===!1)return;this._handleTouchStartPan(a),this.state=c.TOUCH_PAN;break;default:this.state=c.NONE}break;case 2:switch(this.touches.TWO){case q.DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchStartDollyPan(a),this.state=c.TOUCH_DOLLY_PAN;break;case q.DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchStartDollyRotate(a),this.state=c.TOUCH_DOLLY_ROTATE;break;default:this.state=c.NONE}break;default:this.state=c.NONE}this.state!==c.NONE&&this.dispatchEvent(ut)}function le(a){switch(this._trackPointer(a),this.state){case c.TOUCH_ROTATE:if(this.enableRotate===!1)return;this._handleTouchMoveRotate(a),this.update();break;case c.TOUCH_PAN:if(this.enablePan===!1)return;this._handleTouchMovePan(a),this.update();break;case c.TOUCH_DOLLY_PAN:if(this.enableZoom===!1&&this.enablePan===!1)return;this._handleTouchMoveDollyPan(a),this.update();break;case c.TOUCH_DOLLY_ROTATE:if(this.enableZoom===!1&&this.enableRotate===!1)return;this._handleTouchMoveDollyRotate(a),this.update();break;default:this.state=c.NONE}}function ce(a){this.enabled!==!1&&a.preventDefault()}function pe(a){a.key==="Control"&&(this._controlActive=!0,this.domElement.getRootNode().addEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}function de(a){a.key==="Control"&&(this._controlActive=!1,this.domElement.getRootNode().removeEventListener("keyup",this._interceptControlUp,{passive:!0,capture:!0}))}const z=new Nt,f=new l,Z=new l,d=new E,Pt={X:new l(1,0,0),Y:new l(0,1,0),Z:new l(0,0,1)},pt={type:"change"},Mt={type:"mouseDown",mode:null},Et={type:"mouseUp",mode:null},xt={type:"objectChange"};class Ee extends At{constructor(t,e=null){super(void 0,e);const o=new we(this);this._root=o;const s=new be;this._gizmo=s,o.add(s);const r=new ge;this._plane=r,o.add(r);const i=this;function n(P,X){let Q=X;Object.defineProperty(i,P,{get:function(){return Q!==void 0?Q:X},set:function(C){Q!==C&&(Q=C,r[P]=C,s[P]=C,i.dispatchEvent({type:P+"-changed",value:C}),i.dispatchEvent(pt))}}),i[P]=X,r[P]=X,s[P]=X}n("camera",t),n("object",void 0),n("enabled",!0),n("axis",null),n("mode","translate"),n("translationSnap",null),n("rotationSnap",null),n("scaleSnap",null),n("space","world"),n("size",1),n("dragging",!1),n("showX",!0),n("showY",!0),n("showZ",!0),n("minX",-1/0),n("maxX",1/0),n("minY",-1/0),n("maxY",1/0),n("minZ",-1/0),n("maxZ",1/0);const u=new l,y=new l,x=new E,v=new E,D=new l,j=new E,$=new l,O=new l,R=new l,A=0,L=new l;n("worldPosition",u),n("worldPositionStart",y),n("worldQuaternion",x),n("worldQuaternionStart",v),n("cameraPosition",D),n("cameraQuaternion",j),n("pointStart",$),n("pointEnd",O),n("rotationAxis",R),n("rotationAngle",A),n("eye",L),this._offset=new l,this._startNorm=new l,this._endNorm=new l,this._cameraScale=new l,this._parentPosition=new l,this._parentQuaternion=new E,this._parentQuaternionInv=new E,this._parentScale=new l,this._worldScaleStart=new l,this._worldQuaternionInv=new E,this._worldScale=new l,this._positionStart=new l,this._quaternionStart=new E,this._scaleStart=new l,this._getPointer=ue.bind(this),this._onPointerDown=_e.bind(this),this._onPointerHover=me.bind(this),this._onPointerMove=fe.bind(this),this._onPointerUp=ye.bind(this),e!==null&&this.connect(e)}connect(t){super.connect(t),this.domElement.addEventListener("pointerdown",this._onPointerDown),this.domElement.addEventListener("pointermove",this._onPointerHover),this.domElement.addEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="none"}disconnect(){this.domElement.removeEventListener("pointerdown",this._onPointerDown),this.domElement.removeEventListener("pointermove",this._onPointerHover),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.domElement.removeEventListener("pointerup",this._onPointerUp),this.domElement.style.touchAction="auto"}getHelper(){return this._root}pointerHover(t){if(this.object===void 0||this.dragging===!0)return;t!==null&&z.setFromCamera(t,this.camera);const e=dt(this._gizmo.picker[this.mode],z);e?this.axis=e.object.name:this.axis=null}pointerDown(t){if(!(this.object===void 0||this.dragging===!0||t!=null&&t.button!==0)&&this.axis!==null){t!==null&&z.setFromCamera(t,this.camera);const e=dt(this._plane,z,!0);e&&(this.object.updateMatrixWorld(),this.object.parent.updateMatrixWorld(),this._positionStart.copy(this.object.position),this._quaternionStart.copy(this.object.quaternion),this._scaleStart.copy(this.object.scale),this.object.matrixWorld.decompose(this.worldPositionStart,this.worldQuaternionStart,this._worldScaleStart),this.pointStart.copy(e.point).sub(this.worldPositionStart)),this.dragging=!0,Mt.mode=this.mode,this.dispatchEvent(Mt)}}pointerMove(t){const e=this.axis,o=this.mode,s=this.object;let r=this.space;if(o==="scale"?r="local":(e==="E"||e==="XYZE"||e==="XYZ")&&(r="world"),s===void 0||e===null||this.dragging===!1||t!==null&&t.button!==-1)return;t!==null&&z.setFromCamera(t,this.camera);const i=dt(this._plane,z,!0);if(i){if(this.pointEnd.copy(i.point).sub(this.worldPositionStart),o==="translate")this._offset.copy(this.pointEnd).sub(this.pointStart),r==="local"&&e!=="XYZ"&&this._offset.applyQuaternion(this._worldQuaternionInv),e.indexOf("X")===-1&&(this._offset.x=0),e.indexOf("Y")===-1&&(this._offset.y=0),e.indexOf("Z")===-1&&(this._offset.z=0),r==="local"&&e!=="XYZ"?this._offset.applyQuaternion(this._quaternionStart).divide(this._parentScale):this._offset.applyQuaternion(this._parentQuaternionInv).divide(this._parentScale),s.position.copy(this._offset).add(this._positionStart),this.translationSnap&&(r==="local"&&(s.position.applyQuaternion(d.copy(this._quaternionStart).invert()),e.search("X")!==-1&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.position.applyQuaternion(this._quaternionStart)),r==="world"&&(s.parent&&s.position.add(f.setFromMatrixPosition(s.parent.matrixWorld)),e.search("X")!==-1&&(s.position.x=Math.round(s.position.x/this.translationSnap)*this.translationSnap),e.search("Y")!==-1&&(s.position.y=Math.round(s.position.y/this.translationSnap)*this.translationSnap),e.search("Z")!==-1&&(s.position.z=Math.round(s.position.z/this.translationSnap)*this.translationSnap),s.parent&&s.position.sub(f.setFromMatrixPosition(s.parent.matrixWorld)))),s.position.x=Math.max(this.minX,Math.min(this.maxX,s.position.x)),s.position.y=Math.max(this.minY,Math.min(this.maxY,s.position.y)),s.position.z=Math.max(this.minZ,Math.min(this.maxZ,s.position.z));else if(o==="scale"){if(e.search("XYZ")!==-1){let n=this.pointEnd.length()/this.pointStart.length();this.pointEnd.dot(this.pointStart)<0&&(n*=-1),Z.set(n,n,n)}else f.copy(this.pointStart),Z.copy(this.pointEnd),f.applyQuaternion(this._worldQuaternionInv),Z.applyQuaternion(this._worldQuaternionInv),Z.divide(f),e.search("X")===-1&&(Z.x=1),e.search("Y")===-1&&(Z.y=1),e.search("Z")===-1&&(Z.z=1);s.scale.copy(this._scaleStart).multiply(Z),this.scaleSnap&&(e.search("X")!==-1&&(s.scale.x=Math.round(s.scale.x/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Y")!==-1&&(s.scale.y=Math.round(s.scale.y/this.scaleSnap)*this.scaleSnap||this.scaleSnap),e.search("Z")!==-1&&(s.scale.z=Math.round(s.scale.z/this.scaleSnap)*this.scaleSnap||this.scaleSnap))}else if(o==="rotate"){this._offset.copy(this.pointEnd).sub(this.pointStart);const n=20/this.worldPosition.distanceTo(f.setFromMatrixPosition(this.camera.matrixWorld));let u=!1;e==="XYZE"?(this.rotationAxis.copy(this._offset).cross(this.eye).normalize(),this.rotationAngle=this._offset.dot(f.copy(this.rotationAxis).cross(this.eye))*n):(e==="X"||e==="Y"||e==="Z")&&(this.rotationAxis.copy(Pt[e]),f.copy(Pt[e]),r==="local"&&f.applyQuaternion(this.worldQuaternion),f.cross(this.eye),f.length()===0?u=!0:this.rotationAngle=this._offset.dot(f.normalize())*n),(e==="E"||u)&&(this.rotationAxis.copy(this.eye),this.rotationAngle=this.pointEnd.angleTo(this.pointStart),this._startNorm.copy(this.pointStart).normalize(),this._endNorm.copy(this.pointEnd).normalize(),this.rotationAngle*=this._endNorm.cross(this._startNorm).dot(this.eye)<0?1:-1),this.rotationSnap&&(this.rotationAngle=Math.round(this.rotationAngle/this.rotationSnap)*this.rotationSnap),r==="local"&&e!=="E"&&e!=="XYZE"?(s.quaternion.copy(this._quaternionStart),s.quaternion.multiply(d.setFromAxisAngle(this.rotationAxis,this.rotationAngle)).normalize()):(this.rotationAxis.applyQuaternion(this._parentQuaternionInv),s.quaternion.copy(d.setFromAxisAngle(this.rotationAxis,this.rotationAngle)),s.quaternion.multiply(this._quaternionStart).normalize())}this.dispatchEvent(pt),this.dispatchEvent(xt)}}pointerUp(t){t!==null&&t.button!==0||(this.dragging&&this.axis!==null&&(Et.mode=this.mode,this.dispatchEvent(Et)),this.dragging=!1,this.axis=null)}dispose(){this.disconnect(),this._root.dispose()}attach(t){return this.object=t,this._root.visible=!0,this}detach(){return this.object=void 0,this.axis=null,this._root.visible=!1,this}reset(){this.enabled&&this.dragging&&(this.object.position.copy(this._positionStart),this.object.quaternion.copy(this._quaternionStart),this.object.scale.copy(this._scaleStart),this.dispatchEvent(pt),this.dispatchEvent(xt),this.pointStart.copy(this.pointEnd))}getRaycaster(){return z}getMode(){return this.mode}setMode(t){this.mode=t}setTranslationSnap(t){this.translationSnap=t}setRotationSnap(t){this.rotationSnap=t}setScaleSnap(t){this.scaleSnap=t}setSize(t){this.size=t}setSpace(t){this.space=t}setColors(t,e,o,s){const r=this._gizmo.materialLib;r.xAxis.color.set(t),r.yAxis.color.set(e),r.zAxis.color.set(o),r.active.color.set(s),r.xAxisTransparent.color.set(t),r.yAxisTransparent.color.set(e),r.zAxisTransparent.color.set(o),r.activeTransparent.color.set(s),r.xAxis._color&&r.xAxis._color.set(t),r.yAxis._color&&r.yAxis._color.set(e),r.zAxis._color&&r.zAxis._color.set(o),r.active._color&&r.active._color.set(s),r.xAxisTransparent._color&&r.xAxisTransparent._color.set(t),r.yAxisTransparent._color&&r.yAxisTransparent._color.set(e),r.zAxisTransparent._color&&r.zAxisTransparent._color.set(o),r.activeTransparent._color&&r.activeTransparent._color.set(s)}}function ue(a){if(this.domElement.ownerDocument.pointerLockElement)return{x:0,y:0,button:a.button};{const t=this.domElement.getBoundingClientRect();return{x:(a.clientX-t.left)/t.width*2-1,y:-(a.clientY-t.top)/t.height*2+1,button:a.button}}}function me(a){if(this.enabled)switch(a.pointerType){case"mouse":case"pen":this.pointerHover(this._getPointer(a));break}}function _e(a){this.enabled&&(document.pointerLockElement||this.domElement.setPointerCapture(a.pointerId),this.domElement.addEventListener("pointermove",this._onPointerMove),this.pointerHover(this._getPointer(a)),this.pointerDown(this._getPointer(a)))}function fe(a){this.enabled&&this.pointerMove(this._getPointer(a))}function ye(a){this.enabled&&(this.domElement.releasePointerCapture(a.pointerId),this.domElement.removeEventListener("pointermove",this._onPointerMove),this.pointerUp(this._getPointer(a)))}function dt(a,t,e){const o=t.intersectObject(a,!0);for(let s=0;s<o.length;s++)if(o[s].object.visible||e)return o[s];return!1}const nt=new Ft,p=new l(0,1,0),St=new l(0,0,0),Tt=new vt,at=new E,ht=new E,I=new l,Dt=new vt,B=new l(1,0,0),H=new l(0,1,0),V=new l(0,0,1),rt=new l,K=new l,G=new l;class we extends lt{constructor(t){super(),this.isTransformControlsRoot=!0,this.controls=t,this.visible=!1}updateMatrixWorld(t){const e=this.controls;e.object!==void 0&&(e.object.updateMatrixWorld(),e.object.parent===null?console.error("TransformControls: The attached 3D object must be a part of the scene graph."):e.object.parent.matrixWorld.decompose(e._parentPosition,e._parentQuaternion,e._parentScale),e.object.matrixWorld.decompose(e.worldPosition,e.worldQuaternion,e._worldScale),e._parentQuaternionInv.copy(e._parentQuaternion).invert(),e._worldQuaternionInv.copy(e.worldQuaternion).invert()),e.camera.updateMatrixWorld(),e.camera.matrixWorld.decompose(e.cameraPosition,e.cameraQuaternion,e._cameraScale),e.camera.isOrthographicCamera?e.camera.getWorldDirection(e.eye).negate():e.eye.copy(e.cameraPosition).sub(e.worldPosition).normalize(),super.updateMatrixWorld(t)}dispose(){this.traverse(function(t){t.geometry&&t.geometry.dispose(),t.material&&t.material.dispose()})}}class be extends lt{constructor(){super(),this.isTransformControlsGizmo=!0,this.type="TransformControlsGizmo";const t=new It({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),e=new Ut({depthTest:!1,depthWrite:!1,fog:!1,toneMapped:!1,transparent:!0}),o=t.clone();o.opacity=.15;const s=e.clone();s.opacity=.5;const r=t.clone();r.color.setHex(16711680);const i=t.clone();i.color.setHex(65280);const n=t.clone();n.color.setHex(255);const u=t.clone();u.color.setHex(16711680),u.opacity=.5;const y=t.clone();y.color.setHex(65280),y.opacity=.5;const x=t.clone();x.color.setHex(255),x.opacity=.5;const v=t.clone();v.opacity=.25;const D=t.clone();D.color.setHex(16776960),D.opacity=.25;const j=t.clone();j.color.setHex(16776960);const $=t.clone();$.color.setHex(7895160),this.materialLib={xAxis:r,yAxis:i,zAxis:n,active:j,xAxisTransparent:u,yAxisTransparent:y,zAxisTransparent:x,activeTransparent:D};const O=new b(0,.04,.1,12);O.translate(0,.05,0);const R=new _(.08,.08,.08);R.translate(0,.04,0);const A=new ft;A.setAttribute("position",new yt([0,0,0,1,0,0],3));const L=new b(.0075,.0075,.5,3);L.translate(0,.25,0);function P(M,J){const S=new W(M,.0075,3,64,J*Math.PI*2);return S.rotateY(Math.PI/2),S.rotateX(Math.PI/2),S}function X(){const M=new ft;return M.setAttribute("position",new yt([0,0,0,1,1,1],3)),M}const Q={X:[[new h(O,r),[.5,0,0],[0,0,-Math.PI/2]],[new h(O,r),[-.5,0,0],[0,0,Math.PI/2]],[new h(L,r),[0,0,0],[0,0,-Math.PI/2]]],Y:[[new h(O,i),[0,.5,0]],[new h(O,i),[0,-.5,0],[Math.PI,0,0]],[new h(L,i)]],Z:[[new h(O,n),[0,0,.5],[Math.PI/2,0,0]],[new h(O,n),[0,0,-.5],[-Math.PI/2,0,0]],[new h(L,n),null,[Math.PI/2,0,0]]],XYZ:[[new h(new st(.1,0),v),[0,0,0]]],XY:[[new h(new _(.15,.15,.01),x),[.15,.15,0]]],YZ:[[new h(new _(.15,.15,.01),u),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new h(new _(.15,.15,.01),y),[.15,0,.15],[-Math.PI/2,0,0]]]},C={X:[[new h(new b(.2,0,.6,4),o),[.3,0,0],[0,0,-Math.PI/2]],[new h(new b(.2,0,.6,4),o),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new h(new b(.2,0,.6,4),o),[0,.3,0]],[new h(new b(.2,0,.6,4),o),[0,-.3,0],[0,0,Math.PI]]],Z:[[new h(new b(.2,0,.6,4),o),[0,0,.3],[Math.PI/2,0,0]],[new h(new b(.2,0,.6,4),o),[0,0,-.3],[-Math.PI/2,0,0]]],XYZ:[[new h(new st(.2,0),o)]],XY:[[new h(new _(.2,.2,.01),o),[.15,.15,0]]],YZ:[[new h(new _(.2,.2,.01),o),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new h(new _(.2,.2,.01),o),[.15,0,.15],[-Math.PI/2,0,0]]]},Rt={START:[[new h(new st(.01,2),s),null,null,null,"helper"]],END:[[new h(new st(.01,2),s),null,null,null,"helper"]],DELTA:[[new k(X(),s),null,null,null,"helper"]],X:[[new k(A,s),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new k(A,s),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new k(A,s),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]},Lt={XYZE:[[new h(P(.5,1),$),null,[0,Math.PI/2,0]]],X:[[new h(P(.5,.5),r)]],Y:[[new h(P(.5,.5),i),null,[0,0,-Math.PI/2]]],Z:[[new h(P(.5,.5),n),null,[0,Math.PI/2,0]]],E:[[new h(P(.75,1),D),null,[0,Math.PI/2,0]]]},Yt={AXIS:[[new k(A,s),[-1e3,0,0],null,[1e6,1,1],"helper"]]},jt={XYZE:[[new h(new qt(.25,10,8),o)]],X:[[new h(new W(.5,.1,4,24),o),[0,0,0],[0,-Math.PI/2,-Math.PI/2]]],Y:[[new h(new W(.5,.1,4,24),o),[0,0,0],[Math.PI/2,0,0]]],Z:[[new h(new W(.5,.1,4,24),o),[0,0,0],[0,0,-Math.PI/2]]],E:[[new h(new W(.75,.1,2,24),o)]]},kt={X:[[new h(R,r),[.5,0,0],[0,0,-Math.PI/2]],[new h(L,r),[0,0,0],[0,0,-Math.PI/2]],[new h(R,r),[-.5,0,0],[0,0,Math.PI/2]]],Y:[[new h(R,i),[0,.5,0]],[new h(L,i)],[new h(R,i),[0,-.5,0],[0,0,Math.PI]]],Z:[[new h(R,n),[0,0,.5],[Math.PI/2,0,0]],[new h(L,n),[0,0,0],[Math.PI/2,0,0]],[new h(R,n),[0,0,-.5],[-Math.PI/2,0,0]]],XY:[[new h(new _(.15,.15,.01),x),[.15,.15,0]]],YZ:[[new h(new _(.15,.15,.01),u),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new h(new _(.15,.15,.01),y),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new h(new _(.1,.1,.1),v)]]},Zt={X:[[new h(new b(.2,0,.6,4),o),[.3,0,0],[0,0,-Math.PI/2]],[new h(new b(.2,0,.6,4),o),[-.3,0,0],[0,0,Math.PI/2]]],Y:[[new h(new b(.2,0,.6,4),o),[0,.3,0]],[new h(new b(.2,0,.6,4),o),[0,-.3,0],[0,0,Math.PI]]],Z:[[new h(new b(.2,0,.6,4),o),[0,0,.3],[Math.PI/2,0,0]],[new h(new b(.2,0,.6,4),o),[0,0,-.3],[-Math.PI/2,0,0]]],XY:[[new h(new _(.2,.2,.01),o),[.15,.15,0]]],YZ:[[new h(new _(.2,.2,.01),o),[0,.15,.15],[0,Math.PI/2,0]]],XZ:[[new h(new _(.2,.2,.01),o),[.15,0,.15],[-Math.PI/2,0,0]]],XYZ:[[new h(new _(.2,.2,.2),o),[0,0,0]]]},Xt={X:[[new k(A,s),[-1e3,0,0],null,[1e6,1,1],"helper"]],Y:[[new k(A,s),[0,-1e3,0],[0,0,Math.PI/2],[1e6,1,1],"helper"]],Z:[[new k(A,s),[0,0,-1e3],[0,-Math.PI/2,0],[1e6,1,1],"helper"]]};function Y(M){const J=new lt;for(const S in M)for(let N=M[S].length;N--;){const w=M[S][N][0].clone(),tt=M[S][N][1],et=M[S][N][2],it=M[S][N][3],Ct=M[S][N][4];w.name=S,w.tag=Ct,tt&&w.position.set(tt[0],tt[1],tt[2]),et&&w.rotation.set(et[0],et[1],et[2]),it&&w.scale.set(it[0],it[1],it[2]),w.updateMatrix();const mt=w.geometry.clone();mt.applyMatrix4(w.matrix),w.geometry=mt,w.renderOrder=1/0,w.position.set(0,0,0),w.rotation.set(0,0,0),w.scale.set(1,1,1),J.add(w)}return J}this.gizmo={},this.picker={},this.helper={},this.add(this.gizmo.translate=Y(Q)),this.add(this.gizmo.rotate=Y(Lt)),this.add(this.gizmo.scale=Y(kt)),this.add(this.picker.translate=Y(C)),this.add(this.picker.rotate=Y(jt)),this.add(this.picker.scale=Y(Zt)),this.add(this.helper.translate=Y(Rt)),this.add(this.helper.rotate=Y(Yt)),this.add(this.helper.scale=Y(Xt)),this.picker.translate.visible=!1,this.picker.rotate.visible=!1,this.picker.scale.visible=!1}updateMatrixWorld(t){const o=(this.mode==="scale"?"local":this.space)==="local"?this.worldQuaternion:ht;this.gizmo.translate.visible=this.mode==="translate",this.gizmo.rotate.visible=this.mode==="rotate",this.gizmo.scale.visible=this.mode==="scale",this.helper.translate.visible=this.mode==="translate",this.helper.rotate.visible=this.mode==="rotate",this.helper.scale.visible=this.mode==="scale";let s=[];s=s.concat(this.picker[this.mode].children),s=s.concat(this.gizmo[this.mode].children),s=s.concat(this.helper[this.mode].children);for(let r=0;r<s.length;r++){const i=s[r];i.visible=!0,i.rotation.set(0,0,0),i.position.copy(this.worldPosition);let n;if(this.camera.isOrthographicCamera?n=(this.camera.top-this.camera.bottom)/this.camera.zoom:n=this.worldPosition.distanceTo(this.cameraPosition)*Math.min(1.9*Math.tan(Math.PI*this.camera.fov/360)/this.camera.zoom,7),i.scale.set(1,1,1).multiplyScalar(n*this.size/4),i.tag==="helper"){i.visible=!1,i.name==="AXIS"?(i.visible=!!this.axis,this.axis==="X"&&(d.setFromEuler(nt.set(0,0,0)),i.quaternion.copy(o).multiply(d),Math.abs(p.copy(B).applyQuaternion(o).dot(this.eye))>.9&&(i.visible=!1)),this.axis==="Y"&&(d.setFromEuler(nt.set(0,0,Math.PI/2)),i.quaternion.copy(o).multiply(d),Math.abs(p.copy(H).applyQuaternion(o).dot(this.eye))>.9&&(i.visible=!1)),this.axis==="Z"&&(d.setFromEuler(nt.set(0,Math.PI/2,0)),i.quaternion.copy(o).multiply(d),Math.abs(p.copy(V).applyQuaternion(o).dot(this.eye))>.9&&(i.visible=!1)),this.axis==="XYZE"&&(d.setFromEuler(nt.set(0,Math.PI/2,0)),p.copy(this.rotationAxis),i.quaternion.setFromRotationMatrix(Tt.lookAt(St,p,H)),i.quaternion.multiply(d),i.visible=this.dragging),this.axis==="E"&&(i.visible=!1)):i.name==="START"?(i.position.copy(this.worldPositionStart),i.visible=this.dragging):i.name==="END"?(i.position.copy(this.worldPosition),i.visible=this.dragging):i.name==="DELTA"?(i.position.copy(this.worldPositionStart),i.quaternion.copy(this.worldQuaternionStart),f.set(1e-10,1e-10,1e-10).add(this.worldPositionStart).sub(this.worldPosition).multiplyScalar(-1),f.applyQuaternion(this.worldQuaternionStart.clone().invert()),i.scale.copy(f),i.visible=this.dragging):(i.quaternion.copy(o),this.dragging?i.position.copy(this.worldPositionStart):i.position.copy(this.worldPosition),this.axis&&(i.visible=this.axis.search(i.name)!==-1));continue}i.quaternion.copy(o),this.mode==="translate"||this.mode==="scale"?(i.name==="X"&&Math.abs(p.copy(B).applyQuaternion(o).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),i.name==="Y"&&Math.abs(p.copy(H).applyQuaternion(o).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),i.name==="Z"&&Math.abs(p.copy(V).applyQuaternion(o).dot(this.eye))>.99&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),i.name==="XY"&&Math.abs(p.copy(V).applyQuaternion(o).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),i.name==="YZ"&&Math.abs(p.copy(B).applyQuaternion(o).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1),i.name==="XZ"&&Math.abs(p.copy(H).applyQuaternion(o).dot(this.eye))<.2&&(i.scale.set(1e-10,1e-10,1e-10),i.visible=!1)):this.mode==="rotate"&&(at.copy(o),p.copy(this.eye).applyQuaternion(d.copy(o).invert()),i.name.search("E")!==-1&&i.quaternion.setFromRotationMatrix(Tt.lookAt(this.eye,St,H)),i.name==="X"&&(d.setFromAxisAngle(B,Math.atan2(-p.y,p.z)),d.multiplyQuaternions(at,d),i.quaternion.copy(d)),i.name==="Y"&&(d.setFromAxisAngle(H,Math.atan2(p.x,p.z)),d.multiplyQuaternions(at,d),i.quaternion.copy(d)),i.name==="Z"&&(d.setFromAxisAngle(V,Math.atan2(p.y,p.x)),d.multiplyQuaternions(at,d),i.quaternion.copy(d))),i.visible=i.visible&&(i.name.indexOf("X")===-1||this.showX),i.visible=i.visible&&(i.name.indexOf("Y")===-1||this.showY),i.visible=i.visible&&(i.name.indexOf("Z")===-1||this.showZ),i.visible=i.visible&&(i.name.indexOf("E")===-1||this.showX&&this.showY&&this.showZ),i.material._color=i.material._color||i.material.color.clone(),i.material._opacity=i.material._opacity||i.material.opacity,i.material.color.copy(i.material._color),i.material.opacity=i.material._opacity,this.enabled&&this.axis&&(i.name===this.axis?(i.material.color.copy(this.materialLib.active.color),i.material.opacity=1):this.axis.split("").some(function(u){return i.name===u})&&(i.material.color.copy(this.materialLib.active.color),i.material.opacity=1))}super.updateMatrixWorld(t)}}class ge extends h{constructor(){super(new Wt(1e5,1e5,2,2),new It({visible:!1,wireframe:!0,side:Kt,transparent:!0,opacity:.1,toneMapped:!1})),this.isTransformControlsPlane=!0,this.type="TransformControlsPlane"}updateMatrixWorld(t){let e=this.space;switch(this.position.copy(this.worldPosition),this.mode==="scale"&&(e="local"),rt.copy(B).applyQuaternion(e==="local"?this.worldQuaternion:ht),K.copy(H).applyQuaternion(e==="local"?this.worldQuaternion:ht),G.copy(V).applyQuaternion(e==="local"?this.worldQuaternion:ht),p.copy(K),this.mode){case"translate":case"scale":switch(this.axis){case"X":p.copy(this.eye).cross(rt),I.copy(rt).cross(p);break;case"Y":p.copy(this.eye).cross(K),I.copy(K).cross(p);break;case"Z":p.copy(this.eye).cross(G),I.copy(G).cross(p);break;case"XY":I.copy(G);break;case"YZ":I.copy(rt);break;case"XZ":p.copy(G),I.copy(K);break;case"XYZ":case"E":I.set(0,0,0);break}break;default:I.set(0,0,0)}I.length()===0?this.quaternion.copy(this.cameraQuaternion):(Dt.lookAt(f.set(0,0,0),I,p),this.quaternion.setFromRotationMatrix(Dt)),super.updateMatrixWorld(t)}}class xe extends Gt{constructor(){super(),this.name="RoomEnvironment";const t=new _;t.deleteAttribute("uv");const e=new wt({side:Bt}),o=new wt,s=new Vt(16777215,900,28,2);s.position.set(.418,16.199,.3),this.add(s);const r=new h(t,e);r.position.set(-.757,13.219,.717),r.scale.set(31.713,28.305,28.591),this.add(r);const i=new $t(t,o,6),n=new lt;n.position.set(-10.906,2.009,1.846),n.rotation.set(0,-.195,0),n.scale.set(2.328,7.905,4.651),n.updateMatrix(),i.setMatrixAt(0,n.matrix),n.position.set(-5.607,-.754,-.758),n.rotation.set(0,.994,0),n.scale.set(1.97,1.534,3.955),n.updateMatrix(),i.setMatrixAt(1,n.matrix),n.position.set(6.167,.857,7.803),n.rotation.set(0,.561,0),n.scale.set(3.927,6.285,3.687),n.updateMatrix(),i.setMatrixAt(2,n.matrix),n.position.set(-2.017,.018,6.124),n.rotation.set(0,.333,0),n.scale.set(2.002,4.566,2.064),n.updateMatrix(),i.setMatrixAt(3,n.matrix),n.position.set(2.291,-.756,-2.621),n.rotation.set(0,-.286,0),n.scale.set(1.546,1.552,1.496),n.updateMatrix(),i.setMatrixAt(4,n.matrix),n.position.set(-2.193,-.369,-5.547),n.rotation.set(0,.516,0),n.scale.set(3.875,3.487,2.986),n.updateMatrix(),i.setMatrixAt(5,n.matrix),this.add(i);const u=new h(t,U(50));u.position.set(-16.116,14.37,8.208),u.scale.set(.1,2.428,2.739),this.add(u);const y=new h(t,U(50));y.position.set(-16.109,18.021,-8.207),y.scale.set(.1,2.425,2.751),this.add(y);const x=new h(t,U(17));x.position.set(14.904,12.198,-1.832),x.scale.set(.15,4.265,6.331),this.add(x);const v=new h(t,U(43));v.position.set(-.462,8.89,14.52),v.scale.set(4.38,5.441,.088),this.add(v);const D=new h(t,U(20));D.position.set(3.235,11.486,-12.541),D.scale.set(2.5,2,.1),this.add(D);const j=new h(t,U(100));j.position.set(0,20,0),j.scale.set(1,.1,1),this.add(j)}dispose(){const t=new Set;this.traverse(e=>{e.isMesh&&(t.add(e.geometry),t.add(e.material))});for(const e of t)e.dispose()}}function U(a){return new Jt({color:0,emissive:16777215,emissiveIntensity:a})}export{Me as O,xe as R,Ee as T};
